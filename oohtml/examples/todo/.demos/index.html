<html>

    <head>

        <title>A TODO List in OOHTML</title>
        <meta name="oohtml" content="attr.id=id" />

        <script src="https://unpkg.com/@webqit/play-ui/dist/main.js"></script>
        <script src="https://unpkg.com/@webqit/oohtml/dist/main.js"></script>
        <script>
            // Make PlayUI available globally
            window.$ = window.WQ.$;

            // Create the app
            let app = {
                title: 'My TODO',
                todo: [
                    {desc: 'Task-1'},
                    {desc: 'Task-2'},
                    {desc: 'Task-3'},
                ],
            };
            document.setState(app);
        </script>

        <template name="items">
            
            <li namespace>
                <span id="desc"></span>
                <button id="remove">Remove</button>
                <script type="subscript">
                    this.namespace.desc.innerHTML = desc;
                </script>
            </li>

        </template>

    </head>

    <body>

        <div namespace>

            <h2 id="title"></h2>
            <ol id="items" template="items"></ol>
            <button id="adder">Add</button>
            
            <br /><br />

            <div>
            You can also add items from the console directly.<br />
            Open your console and type: <code>document.state.todo.push({desc:"New Item"})</code>
            </div>

            <script type="subscript">
                this.namespace.title.innerHTML = title;
                this.namespace.adder.addEventListener('click', () => {
                    document.state.todo.push({desc: prompt('Task description'),});
                });
                $(this.namespace.items).itemize(document.state.todo, (callbackType, el, data, index, isUpdate) => {
                    if (callbackType === 'setState' && !isUpdate) {
                        // This means el was newly generated by itemize()
                        el.namespace.remove.addEventListener('click', () => {
                            document.state.todo.splice(index, 1);
                        });
                    }
                });
            </script>

        </div>
    </body>

</html>